var B=0;function T(n,e,t){var L,M;if(n.innerHTML="",!e||e.length===0){let p=document.createElement("p");p.textContent="Trend data will appear once the next game is complete.",n.appendChild(p);return}let r=(L=t.width)!=null?L:320,s=(M=t.height)!=null?M:120,a=12,o=e.map(p=>p.value),l=Math.min(...o),u=Math.max(...o)-l||1,g=p=>a+p/Math.max(e.length-1,1)*(r-a*2),x=p=>a+(1-(p-l)/u)*(s-a*2),h=[],v=[];e.forEach((p,y)=>{let E=g(y),U=x(p.value);v.push(`${y===0?"M":"L"}${E},${U}`),y===0?(h.push(`M${E},${s-a}`),h.push(`L${E},${U}`)):h.push(`L${E},${U}`),y===e.length-1&&(h.push(`L${E},${s-a}`),h.push("Z"))});let c=document.createElementNS("http://www.w3.org/2000/svg","svg"),b=++B;c.setAttribute("viewBox",`0 0 ${r} ${s}`),c.setAttribute("role","img"),c.setAttribute("aria-labelledby",`sparkline-title-${b} sparkline-desc-${b}`);let $=document.createElementNS(c.namespaceURI,"title");$.setAttribute("id",`sparkline-title-${b}`),$.textContent=t.title;let f=document.createElementNS(c.namespaceURI,"desc");f.setAttribute("id",`sparkline-desc-${b}`),f.textContent=t.description;let m=document.createElementNS(c.namespaceURI,"path");m.setAttribute("d",h.join(" ")),m.setAttribute("class","sparkline-fill");let d=document.createElementNS(c.namespaceURI,"path");d.setAttribute("d",v.join(" ")),d.setAttribute("class","sparkline-path");let S=e[e.length-1],C=document.createElementNS(c.namespaceURI,"circle");C.setAttribute("cx",String(g(e.length-1))),C.setAttribute("cy",String(x(S.value))),C.setAttribute("r","4"),C.setAttribute("class","sparkline-point"),c.append($,f,m,d,C),n.appendChild(c)}var H=0;function I(n,e,t){var h,v;if(n.innerHTML="",!e||e.length===0){let c=document.createElement("p");c.textContent="Comparison data not yet available.",n.appendChild(c);return}let r=(h=t.width)!=null?h:360,s=(v=t.height)!=null?v:160,a={top:16,right:24,bottom:24,left:140},o=Math.max(...e.map(c=>c.value),1),l=(s-a.top-a.bottom)/e.length-12,i=document.createElementNS("http://www.w3.org/2000/svg","svg"),u=++H;i.setAttribute("viewBox",`0 0 ${r} ${s}`),i.setAttribute("role","img"),i.setAttribute("aria-labelledby",`bar-title-${u} bar-desc-${u}`);let g=document.createElementNS(i.namespaceURI,"title");g.setAttribute("id",`bar-title-${u}`),g.textContent=t.title;let x=document.createElementNS(i.namespaceURI,"desc");x.setAttribute("id",`bar-desc-${u}`),x.textContent=t.description,i.append(g,x),e.forEach((c,b)=>{let $=document.createElementNS(i.namespaceURI,"g"),f=a.top+b*(l+12),m=document.createElementNS(i.namespaceURI,"text");m.setAttribute("x",String(a.left-12)),m.setAttribute("y",String(f+l/2+6)),m.setAttribute("class","bar-label"),m.setAttribute("text-anchor","end"),m.textContent=c.label;let d=document.createElementNS(i.namespaceURI,"rect");d.setAttribute("x",String(a.left)),d.setAttribute("y",String(f)),d.setAttribute("width",String((r-a.left-a.right)*c.value/o)),d.setAttribute("height",String(Math.max(l,8))),d.setAttribute("rx","6"),d.setAttribute("class",b===0?"bar-rect":"bar-rect-secondary");let S=document.createElementNS(i.namespaceURI,"text");S.setAttribute("x",String(a.left+(r-a.left-a.right)*c.value/o+8)),S.setAttribute("y",String(f+l/2+6)),S.setAttribute("class","bar-value"),S.textContent=`${c.value}`,$.append(d,m,S),i.appendChild($)}),n.appendChild(i)}function N(n){let e=document.createElement("a");e.className="source-badge",e.href=n.url,e.target="_blank",e.rel="noopener",e.setAttribute("aria-label",`${n.name} \u2014 ${n.updateCadence}`),e.textContent=`Source: ${n.name}`;let t=document.createElement("span");return t.textContent=n.updateCadence,e.appendChild(t),e}function R(n){if(!n)return"Last updated: Not available";let e=new Date(n);if(Number.isNaN(e.getTime()))return"Last updated: Invalid date";let t=i=>i.toString().padStart(2,"0"),r=e.getUTCFullYear(),s=t(e.getUTCMonth()+1),a=t(e.getUTCDate()),o=t(e.getUTCHours()),l=t(e.getUTCMinutes());return`Last updated: ${r}-${s}-${a} ${o}:${l} UTC`}async function w(n){try{let e=await fetch(n,{cache:"no-cache"});if(!e.ok)throw new Error(`Failed to load ${n}: ${e.status}`);return await e.json()}catch(e){return console.error(e),null}}function k(n,e){let t=document.querySelector(`[data-source="${n}"]`);if(t){if(t.innerHTML="",!e){t.textContent="Source unavailable";return}t.appendChild(N(e))}}function A(n,e){let t=document.querySelector(`[data-last-updated="${n}"]`);t&&(t.textContent=R(e!=null?e:void 0))}async function P(){let n=document.querySelector('[data-module="power-status"]');if(!n)return;let e=await w("data/power-status.json");if(!e){n.textContent="Status indicators are temporarily unavailable.";return}A("power-status",e.lastUpdated),k("power-status",e.source),n.innerHTML="",e.items.forEach(t=>{var g;let r=document.createElement("article");r.className="status-card",r.tabIndex=0,r.setAttribute("aria-label",`${t.label} is ${t.status} at ${t.value} ${t.unit}`);let s=document.createElement("h3");s.textContent=t.label;let a=document.createElement("span");a.className=`status-tag status-${t.status.toLowerCase()}`,a.textContent=t.status;let o=document.createElement("div");o.className="value",o.textContent=`${t.value.toFixed(1)} ${t.unit}`;let l=document.createElement("p"),i=t.change>0?"+":"";l.textContent=`${i}${t.change.toFixed(1)} vs last check`;let u=document.createElement("p");u.textContent=(g=t.description)!=null?g:"",r.append(s,a,o,l,u),n.appendChild(r)})}async function D(){var r,s;let n=document.querySelector('[data-chart="sparkline"]');if(!n)return;let e=document.getElementById("sparkline-desc"),t=await w("data/team-sparkline.json");if(!t){n.textContent="Unable to load recent milestones.",e&&(e.textContent="");return}A("sparkline",t.lastUpdated),k("sparkline",t.source),T(n,t.values,{title:`${t.team} ${t.metric}`,description:(r=t.summary)!=null?r:`${t.team} ${t.metric}`}),e&&(e.textContent=(s=t.summary)!=null?s:"")}async function j(){var r,s;let n=document.querySelector('[data-chart="bar-chart"]');if(!n)return;let e=document.getElementById("bar-chart-desc"),t=await w("data/conference-bar.json");if(!t){n.textContent="Unable to load checkpoint comparison.",e&&(e.textContent="");return}if(A("bar-chart",t.lastUpdated),k("bar-chart",t.source),I(n,t.groups,{title:`${t.metric} (${t.unit})`,description:(r=t.summary)!=null?r:`${t.metric} comparison`}),e){let a=t.groups.filter(o=>o.context).map(o=>`${o.label}: ${o.context}`).join(" ");e.innerHTML=`<strong>${t.metric}:</strong> ${(s=t.summary)!=null?s:a}`}}async function O(){let n=await w("data/global-stage.json");n&&(A("global-stage",n.lastUpdated),k("global-stage",n.source))}function q(){let n=document.querySelectorAll("[data-chart]");if(n.length===0)return;let e={sparkline:D,"bar-chart":j};if(!("IntersectionObserver"in window)){n.forEach(r=>{var o;let s=(o=r.dataset.chart)!=null?o:"",a=e[s];a&&a()});return}let t=new IntersectionObserver((r,s)=>{r.forEach(a=>{var u;if(!a.isIntersecting)return;let o=a.target,l=(u=o.dataset.chart)!=null?u:"",i=e[l];i&&(i(),s.unobserve(o))})},{threshold:.2});n.forEach(r=>t.observe(r))}window.addEventListener("DOMContentLoaded",()=>{P(),O(),q()});
